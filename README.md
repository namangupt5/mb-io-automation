# MultiBank Web UI Automation Framework

Production-grade Web UI Automation Framework for the [MultiBank Trading Platform](https://trade.multibank.io/) built with enterprise-level architecture and best practices.

---

## üìê Architecture Overview

```
multibank-automation/
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ pages/              # Page Object Model classes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BasePage.ts     # Abstract base with reusable methods
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HomePage.ts     # Home page interactions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NavigationComponent.ts  # Navigation menu component
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TradingPage.ts  # Trading section page object
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AboutPage.ts    # About/Why MultiLink page
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/              # Utility modules
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ playwrightManager.ts   # Browser lifecycle singleton
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ waitUtils.ts    # Centralized explicit wait strategies
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dataLoader.ts   # External JSON test data loader
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.ts       # Winston-based structured logging
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ config/             # Configuration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ playwright.config.ts   # Playwright configuration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ global-setup.ts # Login bypass via storage state
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ env.ts          # Environment variable management
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ hooks.ts        # Cucumber lifecycle hooks
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ test-data/          # External JSON test data
‚îÇ       ‚îú‚îÄ‚îÄ navigation.json
‚îÇ       ‚îú‚îÄ‚îÄ tradingPairs.json
‚îÇ       ‚îî‚îÄ‚îÄ contentValidation.json
‚îÇ
‚îú‚îÄ‚îÄ features/               # Cucumber BDD feature files
‚îÇ   ‚îú‚îÄ‚îÄ navigation.feature
‚îÇ   ‚îú‚îÄ‚îÄ trading.feature
‚îÇ   ‚îî‚îÄ‚îÄ content.feature
‚îÇ
‚îú‚îÄ‚îÄ step-definitions/       # Step definition implementations
‚îÇ   ‚îú‚îÄ‚îÄ navigation.steps.ts
‚îÇ   ‚îú‚îÄ‚îÄ trading.steps.ts
‚îÇ   ‚îî‚îÄ‚îÄ content.steps.ts
‚îÇ
‚îú‚îÄ‚îÄ storage/                # Authentication state storage
‚îÇ   ‚îî‚îÄ‚îÄ auth.json           # Generated by global-setup
‚îÇ
‚îú‚îÄ‚îÄ .github/workflows/
‚îÇ   ‚îî‚îÄ‚îÄ playwright.yml      # CI/CD pipeline
‚îÇ
‚îú‚îÄ‚îÄ cucumber.js             # Cucumber configuration
‚îú‚îÄ‚îÄ tsconfig.json           # TypeScript configuration
‚îú‚îÄ‚îÄ .env                    # Environment variables
‚îú‚îÄ‚îÄ .eslintrc.json          # ESLint configuration
‚îú‚îÄ‚îÄ .prettierrc             # Prettier configuration
‚îî‚îÄ‚îÄ package.json
```

---

## üèó Design Decisions

### Page Object Model (POM)

- **BasePage** provides all reusable interaction methods (click, type, scroll, assertions)
- **No locators in step definitions** ‚Äî all locators are encapsulated in page objects
- **Component-based modeling** ‚Äî `NavigationComponent` is extracted as a reusable component
- **Strict separation of concerns** between pages, steps, data, and utilities

### BDD with Cucumber

- Feature files written in Gherkin for business-readable test specifications
- Step definitions are thin wrappers that delegate to page objects
- Tags for selective execution (`@smoke`, `@regression`, `@navigation`, `@trading`)

### Storage State Authentication

- `global-setup.ts` performs login once and saves browser state to `storage/auth.json`
- Tests **never perform login via UI** ‚Äî they reuse the saved storage state
- Fresh browser context per scenario ensures test isolation

### Data-Driven Testing

- All test data externalized to JSON files in `src/test-data/`
- `DataLoader` utility with caching and typed access
- No hard-coded assertions ‚Äî all expected values come from test data

### Wait Strategy

- **No `page.waitForTimeout()` or `sleep()`** in production code
- Centralized `WaitUtils` class with condition-based waits
- Supports: visibility, hidden, attached, navigation, URL, custom conditions

### Error Handling

- `safeAction()` wrapper with configurable retry
- Graceful error handling in hooks with screenshot/trace capture
- Winston logger for structured, file-based logging

---

## üöÄ Getting Started

### Prerequisites

- Node.js >= 18
- npm >= 9

### Installation

```bash
# Install dependencies
npm install

# Install Playwright browsers
npx playwright install --with-deps
```

### Environment Setup

Copy and configure environment variables:

```bash
# .env file is pre-configured; update credentials if needed
cat .env
```

### Login Bypass Setup

```bash
# Run global setup to generate storage state
npm run global-setup
```

This creates `storage/auth.json` with authenticated browser state.

---

## üß™ Running Tests

### Run All Tests

```bash
npm test
```

### Run by Browser

```bash
npm run test:chromium
npm run test:firefox
npm run test:webkit
```

### Run in Parallel

```bash
npm run test:parallel
```

### Run 3 Features in 3 Browsers (Parallel)

```bash
npm run test:matrix:parallel
```

### Run 3-Browser Matrix + Open Latest Trace

```bash
npm run test:matrix:parallel:trace
```

### Run by Tag

```bash
npm run test:tags -- "@smoke"
npm run test:tags -- "@navigation"
npm run test:tags -- "@trading"
npm run test:tags -- "@content"
npm run test:tags -- "@regression"
```

### Cross-Browser Execution

```bash
# Run sequentially on all browsers
BROWSER=chromium npm test && BROWSER=firefox npm test && BROWSER=webkit npm test
```

---

## üìä Allure Reporting

### Generate Report

```bash
npx allure generate ./allure-results --clean
```

### Open Report

```bash
npx allure open
```

### One Command

```bash
npm run allure:report
```

### Report Features

- Step-by-step execution details
- Screenshots attached after each step
- Trace files generated per scenario
- Environment info
- Test categorization by tags
- Execution timeline

### Open Latest Trace

```bash
npm run trace:latest
```

---

## üîÑ CI/CD Pipeline

### GitHub Actions Workflow

The workflow (`.github/workflows/playwright.yml`) provides:

1. **Trigger**: On push and PR to `main` and `develop`
2. **Matrix Strategy**: Runs tests on `chromium`, `firefox`, and `webkit` in parallel
3. **Steps**:
   - Checkout code
   - Setup Node.js 20
   - Install dependencies
   - Install Playwright browsers
   - Run global setup (login bypass)
   - Execute tests
   - Upload artifacts (Allure results, reports, screenshots, traces)
4. **Report Job**: Generates consolidated Allure report from all browser results
5. **Artifacts**: Uploads Allure results, generated report, screenshots and traces for every run

### Create and Push GitHub Repository

```bash
git init
git add .
git commit -m "Initial automation framework"
git branch -M main
git remote add origin https://github.com/<your-username>/<your-repo-name>.git
git push -u origin main
```

Repository URL format to use:

- https://github.com/<your-username>/<your-repo-name>

### Secrets Required

Set these in GitHub repository settings:

- `LOGIN_EMAIL` ‚Äî Login email for authentication
- `LOGIN_PASSWORD` ‚Äî Login password for authentication

### Task 1 Coverage Status

Core Task 1 scenarios are covered, including:

- Navigation menu visibility/options and functional link checks
- Spot trading pairs, category tabs and pair structure/header validation
- Marketing content and bottom-banner validation
- Download section validation for App Store and Google Play links
- About/Company page content and visual component checks

---

## ‚öôÔ∏è Configuration

### Playwright Config

| Setting    | Value                          |
| ---------- | ------------------------------ |
| Retries    | 2                              |
| Parallel   | Enabled (2 workers)            |
| Trace      | retain-on-failure              |
| Screenshot | only-on-failure                |
| Video      | retain-on-failure              |
| Viewport   | 1920x1080                      |
| Timeout    | 30s (action), 60s (navigation) |

### Browser Projects

- **Chromium** (Chrome channel)
- **Firefox**
- **WebKit** (Safari engine)

---

## üìà Scaling Strategy

1. **Add new pages**: Create a new class extending `BasePage` in `src/pages/`
2. **Add new features**: Create `.feature` file and corresponding step definitions
3. **Add test data**: Create new JSON file in `src/test-data/`
4. **Component reuse**: Extract shared UI components like `NavigationComponent`
5. **Parallel scaling**: Increase `parallel` workers in `cucumber.js`
6. **Cross-team**: Feature files are readable by non-technical stakeholders

---

## üîß Maintainability Strategy

- **Single source of truth** for locators (page objects only)
- **External test data** ‚Äî change expected values without code changes
- **Environment variables** ‚Äî switch environments without code changes
- **Centralized waits** ‚Äî modify timeout strategy in one place
- **Structured logging** ‚Äî debug issues from log files
- **ESLint + Prettier** ‚Äî consistent code style enforced
- **TypeScript strict mode** ‚Äî catch errors at compile time

---

## üîÆ Future Improvements

- [ ] Add API testing layer for backend validation
- [ ] Implement visual regression testing with `@playwright/test` snapshots
- [ ] Add Slack/Teams notification on CI failure
- [ ] Implement test data factory pattern for dynamic data generation
- [ ] Add accessibility testing with axe-playwright
- [ ] Integrate with test management tools (TestRail, Xray)
- [ ] Add performance metrics collection
- [ ] Implement custom Allure annotations for better reporting
- [ ] Add Docker container for consistent CI execution
- [ ] Implement data cleanup utilities for test isolation

---

## üìù Assumptions

1. **Target Application**: https://trade.multibank.io/ is the primary test target
2. **Authentication**: Login credentials are provided; storage state is used to bypass UI login
3. **Dynamic Content**: Trading pairs and prices are dynamically loaded; tests account for loading time
4. **Browser Support**: Chromium, Firefox, and WebKit are the target browsers
5. **Network**: Tests assume stable internet connectivity to the trading platform
6. **Locator Strategy**: Resilient selectors using multiple fallback patterns due to potential class name changes
7. **Test Independence**: Each scenario runs in an isolated browser context
8. **Retry Logic**: 2 retries configured for flaky test mitigation in CI environments
9. **Allure**: Java JDK is required for Allure report generation
10. **Node.js**: Version 18+ is required for Playwright compatibility

---

## üìã Test Scenarios

### Navigation & Layout (5 scenarios)

- Validate top navigation menu visibility
- Validate menu options are displayed
- Validate links redirect correctly
- Validate URL matches expected
- Validate layout consistency

### Trading Functionality (5 scenarios)

- Validate Spot trading section displays pairs
- Validate trading categories exist
- Validate trading pair data structure
- Validate table headers correctness
- Validate dynamic content rendering

### Content Validation (6 scenarios)

- Validate marketing banners at bottom
- Validate App Store download link
- Validate Google Play download link
- Validate About page section headers
- Validate About page paragraph content
- Validate About page visual components

**Total: 16 test scenarios across 3 feature files**

---

## üõ† Development

### Linting

```bash
npm run lint
```

### Formatting

```bash
npm run format
```

### Pre-commit Hooks (Husky)

```bash
npm run prepare
```

---

## License

ISC
